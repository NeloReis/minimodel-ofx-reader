<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Leitor de arquivos OFX de bancos brasileiros">
  <title>OFX Reader - Leitor de Extratos BancÃ¡rios</title>
  <style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   OFX READER - COMPLETE STYLESHEET
   Dark Blue Professional Theme - DASHBOARD EDITION
   Full-Screen Web App with Internal Scrolling
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RESET â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

*, *::before, *::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CSS VARIABLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

:root {
  /* â”€â”€ Dark Blue Backgrounds â”€â”€ */
  --bg-base: #0a1929;
  --bg-primary: #0d1b2a;
  --bg-secondary: #132f4c;
  --bg-tertiary: #1e3a5f;
  --bg-elevated: #0f2740;
  --bg-hover: rgba(25, 118, 210, 0.08);
  --bg-input: #0a1628;
  
  /* â”€â”€ Enhanced Gradient Backgrounds â”€â”€ */
  --bg-gradient: linear-gradient(180deg, #0a1929 0%, #0d1f35 50%, #071320 100%);
  --bg-card-shine: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, transparent 50%);
  --bg-dashboard: linear-gradient(135deg, #0d1b2a 0%, #0f2942 100%);

  /* â”€â”€ Borders â”€â”€ */
  --border-subtle: rgba(144, 202, 249, 0.08);
  --border-default: #2c5282;
  --border-strong: #3d6ca3;
  --border-focus: #1976d2;
  --border-active: #4a90d9;
  
  /* â”€â”€ Enhanced Glow â”€â”€ */
  --glow-accent: 0 0 20px rgba(25, 118, 210, 0.3);
  --glow-success: 0 0 15px rgba(76, 175, 80, 0.3);
  --glow-error: 0 0 15px rgba(244, 67, 54, 0.3);
  --glow-intense: 0 0 40px rgba(25, 118, 210, 0.4);

  /* â”€â”€ Text Colors â”€â”€ */
  --text-primary: #e3f2fd;
  --text-secondary: #90caf9;
  --text-tertiary: #64b5f6;
  --text-muted: #5a7a99;
  --text-inverse: #0a1929;
  --text-dim: #3d5a80;

  /* â”€â”€ Accent & Brand Colors â”€â”€ */
  --accent: #1976d2;
  --accent-rgb: 25, 118, 210;
  --accent-light: #42a5f5;
  --accent-lighter: #64b5f6;
  --accent-dark: #1565c0;
  --accent-darkest: #0d47a1;
  
  /* â”€â”€ Enhanced Gradients â”€â”€ */
  --gradient-accent: linear-gradient(135deg, #1976d2 0%, #42a5f5 100%);
  --gradient-header: linear-gradient(135deg, #0d1b2a 0%, #132f4c 100%);
  --gradient-card: linear-gradient(145deg, #132f4c 0%, #0d1b2a 100%);

  /* â”€â”€ Semantic Colors â”€â”€ */
  --color-success: #4caf50;
  --color-success-rgb: 76, 175, 80;
  --color-error: #f44336;
  --color-error-rgb: 244, 67, 54;
  --color-warning: #ff9800;
  --color-info: #42a5f5;
  
  /* â”€â”€ Semantic Gradients â”€â”€ */
  --gradient-success: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
  --gradient-error: linear-gradient(135deg, #c62828 0%, #f44336 100%);

  /* â”€â”€ Typography â”€â”€ */
  --font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, Tahoma, Geneva, Verdana, sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', 'Consolas', 'Monaco', monospace;
  --font-size-xs: 0.6875rem;
  --font-size-sm: 0.75rem;
  --font-size-base: 0.875rem;
  --font-size-md: 1rem;
  --font-size-lg: 1.125rem;
  --font-size-xl: 1.5rem;
  --font-size-2xl: 2rem;
  --font-size-3xl: 2.5rem;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  --line-height-tight: 1.25;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.625;

  /* â”€â”€ Spacing (4px base unit) â”€â”€ */
  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-5: 1.25rem;
  --space-6: 1.5rem;
  --space-8: 2rem;
  --space-10: 2.5rem;
  --space-12: 3rem;
  --space-16: 4rem;

  /* â”€â”€ Border Radius â”€â”€ */
  --radius-sm: 6px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-xl: 16px;
  --radius-2xl: 24px;
  --radius-full: 9999px;

  /* â”€â”€ Enhanced Shadows â”€â”€ */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.4), 0 1px 2px rgba(0, 0, 0, 0.3);
  --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.3);
  --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.5), 0 6px 10px rgba(0, 0, 0, 0.3);
  --shadow-xl: 0 20px 40px rgba(0, 0, 0, 0.6), 0 10px 20px rgba(0, 0, 0, 0.4);
  --shadow-card: 0 4px 20px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(144, 202, 249, 0.05);
  --shadow-card-hover: 0 8px 30px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(144, 202, 249, 0.1), var(--glow-accent);
  --shadow-inner: inset 0 2px 4px rgba(0, 0, 0, 0.3);

  /* â”€â”€ Transitions (Refined) â”€â”€ */
  --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 400ms cubic-bezier(0.4, 0, 0.6, 1);
  --transition-bounce: 500ms cubic-bezier(0.34, 1.56, 0.64, 1);

  /* â”€â”€ Layout â”€â”€ */
  --header-height: 72px;
  --sidebar-width: 380px;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ BASE STYLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

html {
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  scroll-behavior: smooth;
}

body {
  font-family: var(--font-family);
  font-size: var(--font-size-base);
  line-height: var(--line-height-normal);
  color: var(--text-primary);
  background: var(--bg-dashboard);
  min-height: 100vh;
  overflow: hidden; /* Dashboard handles scroll internally */
  position: relative;
}

/* Subtle background pattern */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-image: 
    radial-gradient(ellipse at 10% 10%, rgba(25, 118, 210, 0.12) 0%, transparent 40%),
    radial-gradient(ellipse at 90% 90%, rgba(66, 165, 245, 0.08) 0%, transparent 40%),
    radial-gradient(ellipse at 50% 50%, rgba(25, 118, 210, 0.03) 0%, transparent 60%);
  pointer-events: none;
  z-index: -1;
}

h1, h2, h3, h4, h5, h6 {
  font-weight: var(--font-weight-semibold);
  line-height: var(--line-height-tight);
  color: var(--text-primary);
}

h1 { font-size: var(--font-size-2xl); }
h2 { font-size: var(--font-size-xl); }
h3 { font-size: var(--font-size-lg); }

p {
  color: var(--text-secondary);
  line-height: var(--line-height-relaxed);
}

/* â”€â”€ Accessibility â”€â”€ */

*:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.4);
  border-radius: var(--radius-sm);
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ DASHBOARD LAYOUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.dashboard {
  display: flex;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.app-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--space-6);
  height: var(--header-height);
  background: linear-gradient(180deg, rgba(13, 27, 42, 0.98) 0%, rgba(13, 27, 42, 0.95) 100%);
  border-bottom: 1px solid var(--border-subtle);
  backdrop-filter: blur(10px);
  flex-shrink: 0;
  position: relative;
  z-index: 100;
}

/* Header left - Logo */
.header-left {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.app-logo {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.app-logo-icon {
  width: 40px;
  height: 40px;
  background: var(--gradient-accent);
  border-radius: var(--radius-lg);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.25rem;
  box-shadow: var(--shadow-md), 0 0 20px rgba(25, 118, 210, 0.3);
}

.app-title {
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-bold);
  color: var(--text-primary);
  background: linear-gradient(135deg, #e3f2fd 0%, #64b5f6 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: -0.02em;
}

/* Header right - Status */
.header-right {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.header-status {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-4);
  background: rgba(25, 118, 210, 0.1);
  border: 1px solid rgba(25, 118, 210, 0.2);
  border-radius: var(--radius-full);
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ MAIN CONTENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.main-content {
  display: flex;
  flex: 1;
  overflow: hidden;
  padding: var(--space-6);
  gap: var(--space-6);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ TOP SECTION (2 Columns) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.top-section {
  display: flex;
  gap: var(--space-6);
  flex-shrink: 0;
  max-height: 45%;
  min-height: 320px;
}

/* Left Column - Drop Zone */
.drop-column {
  flex: 0 0 var(--sidebar-width);
  display: flex;
  flex-direction: column;
}

/* Right Column - Info Cards */
.info-column {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ DROP ZONE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.upload-section {
  display: flex;
  flex-direction: column;
  flex: 1;
}

.upload-zone {
  flex: 1;
  border: 2px dashed var(--border-default);
  border-radius: var(--radius-2xl);
  padding: var(--space-8);
  text-align: center;
  cursor: pointer;
  transition: all var(--transition-base);
  background: var(--bg-primary);
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.upload-zone::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--bg-card-shine);
  opacity: 0;
  transition: opacity var(--transition-base);
}

.upload-zone::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 0;
  height: 0;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(25, 118, 210, 0.15) 0%, transparent 70%);
  transition: width var(--transition-slow), height var(--transition-slow);
}

.upload-zone:hover,
.upload-zone.dragover {
  border-color: var(--accent);
  background: rgba(25, 118, 210, 0.05);
  box-shadow: var(--shadow-lg), var(--glow-accent);
}

.upload-zone:hover::before,
.upload-zone.dragover::before {
  opacity: 1;
}

.upload-zone:hover::after,
.upload-zone.dragover::after {
  width: 500px;
  height: 500px;
}

.upload-icon {
  font-size: 3rem;
  color: var(--accent);
  margin-bottom: var(--space-4);
  display: block;
  position: relative;
  z-index: 1;
  transition: transform var(--transition-bounce);
}

.upload-zone:hover .upload-icon {
  transform: scale(1.15);
}

.upload-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  margin-bottom: var(--space-2);
  position: relative;
  z-index: 1;
}

.upload-subtitle {
  color: var(--text-secondary);
  font-size: var(--font-size-base);
  margin-bottom: var(--space-3);
  position: relative;
  z-index: 1;
}

.upload-hint {
  color: var(--text-muted);
  font-size: var(--font-size-sm);
  position: relative;
  z-index: 1;
}

.file-input {
  display: none;
}

/* File loaded state */
.upload-zone.has-file {
  border-style: solid;
  border-color: var(--color-success);
  background: rgba(76, 175, 80, 0.05);
}

.upload-zone.has-file::before {
  opacity: 1;
  background: linear-gradient(145deg, rgba(76, 175, 80, 0.1) 0%, transparent 50%);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LOADING STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.loading-container {
  display: none;
  align-items: center;
  justify-content: center;
  gap: var(--space-4);
  padding: var(--space-8);
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-card);
}

.loading-container.visible {
  display: flex;
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.spinner {
  width: 36px;
  height: 36px;
  border: 3px solid var(--border-default);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading-text {
  color: var(--text-secondary);
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ERROR MESSAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.error-message {
  display: none;
  align-items: flex-start;
  gap: var(--space-3);
  padding: var(--space-4) var(--space-5);
  background: linear-gradient(135deg, rgba(244, 67, 54, 0.1) 0%, rgba(244, 67, 54, 0.05) 100%);
  border: 1px solid rgba(244, 67, 54, 0.3);
  border-left: 4px solid var(--color-error);
  border-radius: var(--radius-lg);
  color: var(--text-primary);
}

.error-message.visible {
  display: flex;
  animation: shake 0.5s ease-out, fadeIn 0.3s ease-out;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20%, 60% { transform: translateX(-5px); }
  40%, 80% { transform: translateX(5px); }
}

.error-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.error-text {
  flex: 1;
  font-size: var(--font-size-base);
  line-height: var(--line-height-relaxed);
  color: var(--text-primary);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ INFO CARDS SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.info-section {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
}

.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: var(--space-3);
  margin-bottom: var(--space-4);
  flex-shrink: 0;
}

.section-title {
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.section-title-icon {
  font-size: 1rem;
}

.info-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--space-3);
  flex-shrink: 0;
}

.info-card {
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  transition: all var(--transition-base);
  position: relative;
  overflow: hidden;
}

.info-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: var(--gradient-accent);
  transform: scaleX(0);
  transform-origin: left;
  transition: transform var(--transition-base);
}

.info-card:hover {
  border-color: var(--border-default);
  box-shadow: var(--shadow-card-hover);
  transform: translateY(-2px);
}

.info-card:hover::before {
  transform: scaleX(1);
}

.info-card.highlight {
  background: linear-gradient(145deg, #132f4c 0%, #0d1f35 100%);
  border-color: rgba(25, 118, 210, 0.3);
}

.card-icon {
  width: 32px;
  height: 32px;
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  margin-bottom: var(--space-2);
  background: rgba(25, 118, 210, 0.15);
  color: var(--accent-light);
}

.card-label {
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-semibold);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
  margin-bottom: var(--space-1);
}

.card-value {
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-bold);
  color: var(--text-primary);
  word-break: break-word;
  line-height: var(--line-height-tight);
}

.card-value.highlight {
  background: var(--gradient-accent);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.card-value.balance-positive {
  color: var(--color-success);
}

.card-value.balance-negative {
  color: var(--color-error);
}

.card-subvalue {
  font-size: var(--font-size-xs);
  color: var(--text-muted);
  margin-top: var(--space-1);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ DATA SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.data-section {
  display: none;
  flex-direction: column;
  flex: 1;
  min-height: 0;
}

.data-section.visible {
  display: flex;
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ BOTTOM SECTION - TRANSACTION LIST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.bottom-section {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
  background: var(--bg-primary);
  border-radius: var(--radius-2xl);
  border: 1px solid var(--border-subtle);
  overflow: hidden;
}

.list-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4) var(--space-5);
  background: linear-gradient(180deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
  border-bottom: 1px solid var(--border-subtle);
  flex-shrink: 0;
}

.list-title {
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.list-count {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-1) var(--space-3);
  background: rgba(25, 118, 210, 0.15);
  border: 1px solid rgba(25, 118, 210, 0.3);
  border-radius: var(--radius-full);
  color: var(--accent-light);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
}

/* Scrollable list container */
.list-container {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
}

.list-container::-webkit-scrollbar {
  width: 8px;
}

.list-container::-webkit-scrollbar-track {
  background: var(--bg-primary);
}

.list-container::-webkit-scrollbar-thumb {
  background: var(--border-default);
  border-radius: var(--radius-full);
}

.list-container::-webkit-scrollbar-thumb:hover {
  background: var(--border-strong);
}

/* Transaction list */
.transaction-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.transaction-item {
  display: flex;
  align-items: center;
  padding: var(--space-3) var(--space-5);
  border-bottom: 1px solid var(--border-subtle);
  transition: all var(--transition-fast);
}

.transaction-item:hover {
  background: var(--bg-hover);
}

.transaction-item:last-child {
  border-bottom: none;
}

.transaction-item:nth-child(even) {
  background: rgba(30, 58, 95, 0.1);
}

.transaction-item:nth-child(even):hover {
  background: var(--bg-hover);
}

.transaction-date {
  width: 90px;
  flex-shrink: 0;
  font-family: var(--font-mono);
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
}

.transaction-amount {
  width: 130px;
  flex-shrink: 0;
  text-align: right;
  font-family: var(--font-mono);
  font-weight: var(--font-weight-bold);
  font-size: var(--font-size-sm);
  padding-right: var(--space-4);
}

.transaction-amount.credit {
  color: var(--color-success);
}

.transaction-amount.debit {
  color: var(--color-error);
}

.transaction-description {
  flex: 1;
  min-width: 0;
  font-size: var(--font-size-sm);
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Empty state */
.list-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--space-12);
  color: var(--text-muted);
}

.list-empty-icon {
  font-size: 3rem;
  margin-bottom: var(--space-4);
  opacity: 0.5;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

@media (max-width: 1024px) {
  .main-content {
    flex-direction: column;
    overflow-y: auto;
  }
  
  .top-section {
    flex-direction: column;
    max-height: none;
    min-height: auto;
  }
  
  .drop-column {
    flex: none;
  }
  
  .info-grid {
    grid-template-columns: repeat(3, 1fr);
  }
  
  .bottom-section {
    min-height: 400px;
  }
}

@media (max-width: 768px) {
  .app-header {
    padding: 0 var(--space-4);
  }
  
  .main-content {
    padding: var(--space-4);
    gap: var(--space-4);
  }
  
  .info-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .transaction-date {
    width: 70px;
    font-size: var(--font-size-xs);
  }
  
  .transaction-amount {
    width: 100px;
    font-size: var(--font-size-xs);
  }
}

@media (max-width: 480px) {
  .info-grid {
    grid-template-columns: 1fr;
  }
  
  .transaction-item {
    padding: var(--space-2) var(--space-3);
  }
  
  .transaction-date {
    width: 60px;
  }
  
  .transaction-amount {
    width: 80px;
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PRINT STYLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

@media print {
  * {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
  
  body {
    background: white;
    color: black;
  }
  
  .dashboard {
    display: block;
    height: auto;
    overflow: visible;
  }
  
  .app-header {
    border-bottom: 2px solid #333;
  }
  
  .app-title {
    color: #000;
    background: none;
    -webkit-text-fill-color: initial;
  }
  
  .drop-column,
  .loading-container,
  .error-message {
    display: none !important;
  }
  
  .info-card {
    background: white;
    border: 1px solid #ddd;
    break-inside: avoid;
    page-break-inside: avoid;
  }
  
  .bottom-section {
    background: white;
    border: 1px solid #ddd;
  }
  
  .transaction-item {
    border-bottom: 1px solid #ddd;
  }
  
  .transaction-amount.credit {
    color: #2e7d32;
  }
  
  .transaction-amount.debit {
    color: #c62828;
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ UTILITY CLASSES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.hidden {
  display: none !important;
}

.visible {
  display: block !important;
}

.text-center {
  text-align: center;
}

.text-right {
  text-align: right;
}

.text-muted {
  color: var(--text-muted);
}

.font-mono {
  font-family: var(--font-mono);
}

.mt-4 { margin-top: var(--space-4); }
.mt-6 { margin-top: var(--space-6); }
.mb-4 { margin-bottom: var(--space-4); }
.mb-6 { margin-bottom: var(--space-6); }
  </style>
</head>
<body>
  <div class="dashboard">
    
    <!-- HEADER -->
    <header class="app-header">
      <div class="header-left">
        <div class="app-logo">
          <div class="app-logo-icon">ğŸ“Š</div>
          <h1 class="app-title">OFX Reader</h1>
        </div>
      </div>
      <div class="header-right">
        <div class="header-status" id="headerStatus">
          <span>ğŸ“„</span>
          <span>Aguardando arquivo</span>
        </div>
      </div>
    </header>

    <!-- MAIN CONTENT -->
    <main class="main-content">
      
      <!-- TOP SECTION -->
      <div class="top-section">
        
        <!-- Left Column - Drop Zone -->
        <div class="drop-column">
          
          <!-- Upload Zone -->
          <div class="upload-section">
            <div class="upload-zone" id="uploadZone">
              <span class="upload-icon">ğŸ“</span>
              <h2 class="upload-title">Arraste seu arquivo OFX</h2>
              <p class="upload-subtitle">ou clique para selecionar</p>
              <p class="upload-hint">Arquivos .ofx de bancos brasileiros</p>
              <input type="file" id="fileInput" class="file-input" accept=".ofx">
            </div>
          </div>

          <!-- Loading State -->
          <div class="loading-container" id="loadingContainer">
            <div class="spinner"></div>
            <span class="loading-text">Processando arquivo...</span>
          </div>

          <!-- Error Message -->
          <div class="error-message" id="errorMessage">
            <span class="error-icon">âš ï¸</span>
            <span class="error-text" id="errorText"></span>
          </div>
        </div>

        <!-- Right Column - Info Cards -->
        <div class="info-column">
          <div class="info-section" id="infoSection">
            <div class="section-header">
              <h2 class="section-title">
                <span class="section-title-icon">ğŸ </span>
                InformaÃ§Ãµes da Conta
              </h2>
            </div>
            <div class="info-grid" id="infoGrid">
              <!-- Cards will be inserted here by JavaScript -->
            </div>
          </div>
        </div>
      </div>

      <!-- BOTTOM SECTION - Transaction List -->
      <div class="bottom-section" id="bottomSection">
        <div class="list-header">
          <h2 class="list-title">
            <span>ğŸ“‹</span>
            TransaÃ§Ãµes
          </h2>
          <span class="list-count" id="transactionCount">
            <span>0</span> transaÃ§Ãµes
          </span>
        </div>
        <div class="list-container" id="listContainer">
          <ul class="transaction-list" id="transactionList">
            <!-- Items will be inserted here by JavaScript -->
          </ul>
        </div>
      </div>

    </main>

  </div>
  position: relative;
  overflow: hidden;
}

/* Subtle inner shine */
.upload-zone::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--bg-card-shine);
  opacity: 0;
  transition: opacity var(--transition-base);
}

/* Animated background ring */
.upload-zone::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 0;
  height: 0;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(25, 118, 210, 0.15) 0%, transparent 70%);
  transition: width var(--transition-slow), height var(--transition-slow);
}

.upload-zone:hover,
.upload-zone.dragover {
  border-color: var(--accent);
  background: rgba(25, 118, 210, 0.05);
  box-shadow: var(--shadow-lg), var(--glow-accent);
  transform: translateY(-4px);
}

.upload-zone:hover::before,
.upload-zone.dragover::before {
  opacity: 1;
}

.upload-zone:hover::after,
.upload-zone.dragover::after {
  width: 600px;
  height: 600px;
}

.upload-icon {
  font-size: 3.5rem;
  color: var(--accent);
  margin-bottom: var(--space-4);
  display: block;
  position: relative;
  z-index: 1;
  transition: transform var(--transition-bounce);
}

.upload-zone:hover .upload-icon {
  transform: scale(1.1) translateY(-5px);
}

.upload-title {
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  margin-bottom: var(--space-2);
  position: relative;
  z-index: 1;
}

.upload-subtitle {
  color: var(--text-secondary);
  font-size: var(--font-size-md);
  margin-bottom: var(--space-4);
  position: relative;
  z-index: 1;
}

.upload-hint {
  color: var(--text-tertiary);
  font-size: var(--font-size-sm);
  position: relative;
  z-index: 1;
}

.file-input {
  display: none;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ LOADING STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.loading-container {
  display: none;
  align-items: center;
  justify-content: center;
  gap: var(--space-4);
  padding: var(--space-10);
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-card);
}

.loading-container.visible {
  display: flex;
  animation: fadeIn 0.3s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.spinner {
  width: 40px;
  height: 40px;
  border: 3px solid var(--border-default);
  border-top-color: var(--accent);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.loading-text {
  color: var(--text-secondary);
  font-size: var(--font-size-md);
  font-weight: var(--font-weight-medium);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ERROR MESSAGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.error-message {
  display: none;
  align-items: flex-start;
  gap: var(--space-3);
  padding: var(--space-5);
  background: linear-gradient(135deg, rgba(244, 67, 54, 0.1) 0%, rgba(244, 67, 54, 0.05) 100%);
  border: 1px solid rgba(244, 67, 54, 0.3);
  border-left: 4px solid var(--color-error);
  border-radius: var(--radius-lg);
  color: var(--text-primary);
}

.error-message.visible {
  display: flex;
  animation: shake 0.5s ease-out, fadeIn 0.3s ease-out;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20%, 60% { transform: translateX(-5px); }
  40%, 80% { transform: translateX(5px); }
}

.error-icon {
  font-size: 1.5rem;
  flex-shrink: 0;
}

.error-text {
  flex: 1;
  font-size: var(--font-size-base);
  line-height: var(--line-height-relaxed);
  color: var(--text-primary);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ DATA SECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.data-section {
  display: none;
  flex-direction: column;
  gap: var(--space-8);
}

.data-section.visible {
  display: flex;
  animation: slideUp 0.4s ease-out;
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ METADATA CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.metadata-section {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: var(--space-4);
}

.section-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  margin-bottom: var(--space-2);
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.section-title-icon {
  font-size: 1.25rem;
}

.metadata-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: var(--space-4);
}

.metadata-card {
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-xl);
  padding: var(--space-5);
  transition: all var(--transition-base);
  position: relative;
  overflow: hidden;
  box-shadow: var(--shadow-card);
}

/* Subtle shine effect */
.metadata-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: var(--bg-card-shine);
  opacity: 0;
  transition: opacity var(--transition-base);
}

/* Accent line on hover */
.metadata-card::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: var(--gradient-accent);
  transform: scaleX(0);
  transform-origin: left;
  transition: transform var(--transition-base);
}

.metadata-card:hover {
  border-color: var(--border-default);
  box-shadow: var(--shadow-card-hover);
  transform: translateY(-4px);
}

.metadata-card:hover::before {
  opacity: 1;
}

.metadata-card:hover::after {
  transform: scaleX(1);
}

/* Staggered animation for cards */
.metadata-card {
  animation: cardFadeIn 0.5s ease-out backwards;
}

.metadata-card:nth-child(1) { animation-delay: 0.05s; }
.metadata-card:nth-child(2) { animation-delay: 0.1s; }
.metadata-card:nth-child(3) { animation-delay: 0.15s; }
.metadata-card:nth-child(4) { animation-delay: 0.2s; }
.metadata-card:nth-child(5) { animation-delay: 0.25s; }
.metadata-card:nth-child(6) { animation-delay: 0.3s; }

@keyframes cardFadeIn {
  from {
    opacity: 0;
    transform: translateY(15px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.card-icon {
  width: 40px;
  height: 40px;
  border-radius: var(--radius-lg);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.25rem;
  margin-bottom: var(--space-3);
  background: rgba(25, 118, 210, 0.15);
  color: var(--accent-light);
}

.card-label {
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-semibold);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-tertiary);
  margin-bottom: var(--space-2);
}

.card-value {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-bold);
  color: var(--text-primary);
  word-break: break-word;
  line-height: var(--line-height-tight);
}

.card-value.highlight {
  background: var(--gradient-accent);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.card-value.balance-positive {
  color: var(--color-success);
}

.card-value.balance-negative {
  color: var(--color-error);
}

.card-subvalue {
  font-size: var(--font-size-sm);
  color: var(--text-muted);
  margin-top: var(--space-2);
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ TRANSACTION TABLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.transactions-section {
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.table-container {
  background: var(--bg-secondary);
  border: 1px solid var(--border-subtle);
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow-card);
}

/* Horizontal scroll wrapper */
.table-scroll-wrapper {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: thin;
  scrollbar-color: var(--border-default) var(--bg-secondary);
}

.table-scroll-wrapper::-webkit-scrollbar {
  height: 8px;
}

.table-scroll-wrapper::-webkit-scrollbar-track {
  background: var(--bg-secondary);
}

.table-scroll-wrapper::-webkit-scrollbar-thumb {
  background: var(--border-default);
  border-radius: var(--radius-full);
}

.transaction-table {
  width: 100%;
  min-width: 700px;
  border-collapse: collapse;
  font-size: var(--font-size-base);
}

.transaction-table thead {
  background: linear-gradient(180deg, var(--bg-tertiary) 0%, var(--bg-secondary) 100%);
  position: sticky;
  top: 0;
  z-index: 10;
}

.transaction-table th {
  text-align: left;
  padding: var(--space-4) var(--space-5);
  color: var(--text-secondary);
  font-weight: var(--font-weight-semibold);
  font-size: var(--font-size-xs);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  border-bottom: 2px solid var(--border-default);
  white-space: nowrap;
}

.transaction-table th.align-right {
  text-align: right;
}

.transaction-table tbody tr {
  border-bottom: 1px solid var(--border-subtle);
  transition: all var(--transition-fast);
  position: relative;
}

/* Subtle alternating rows */
.transaction-table tbody tr:nth-child(even) {
  background: rgba(30, 58, 95, 0.15);
}

.transaction-table tbody tr:hover {
  background: var(--bg-hover);
}

.transaction-table tbody tr:last-child {
  border-bottom: none;
}

/* Row entrance animation */
.transaction-table tbody tr {
  animation: rowFadeIn 0.3s ease-out backwards;
}

@keyframes rowFadeIn {
  from {
    opacity: 0;
    transform: translateX(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.transaction-table td {
  padding: var(--space-4) var(--space-5);
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  vertical-align: middle;
}

.transaction-table td.date-cell {
  font-family: var(--font-mono);
  color: var(--text-secondary);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
}

.transaction-table td.amount-cell {
  text-align: right;
  font-family: var(--font-mono);
  font-weight: var(--font-weight-semibold);
  font-size: var(--font-size-base);
}

.transaction-table td.amount-cell.credit {
  color: var(--color-success);
  font-weight: var(--font-weight-bold);
}

.transaction-table td.amount-cell.debit {
  color: var(--color-error);
  font-weight: var(--font-weight-bold);
}

.transaction-table td.description-cell {
  max-width: 500px;
  color: var(--text-primary);
  font-size: var(--font-size-sm);
}

/* Transaction count badge */
.transaction-count {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-4);
  background: rgba(25, 118, 210, 0.15);
  border: 1px solid rgba(25, 118, 210, 0.3);
  border-radius: var(--radius-full);
  color: var(--accent-light);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
}

/* Empty state */
.table-empty {
  text-align: center;
  padding: var(--space-12) var(--space-6);
  color: var(--text-muted);
}

.table-empty-icon {
  font-size: 3rem;
  margin-bottom: var(--space-4);
  opacity: 0.5;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RESPONSIVE DESIGN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

/* Tablet (768px) */
@media (max-width: 768px) {
  :root {
    --container-padding: var(--space-4);
    --header-height: 64px;
  }

  .app-container {
    padding: var(--space-4);
    gap: var(--space-6);
  }

  .app-title {
    font-size: var(--font-size-xl);
  }

  .upload-zone {
    padding: var(--space-8) var(--space-4);
  }

  .metadata-grid {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-3);
  }

  .metadata-card {
    padding: var(--space-4);
  }

  .card-value {
    font-size: var(--font-size-md);
  }

  .transaction-table {
    font-size: var(--font-size-sm);
  }

  .transaction-table th,
  .transaction-table td {
    padding: var(--space-2) var(--space-3);
  }

  .transaction-table td.description-cell {
    max-width: 300px;
  }
}

/* Mobile (480px) */
@media (max-width: 480px) {
  .app-container {
    padding: var(--space-3);
    gap: var(--space-4);
  }

  .app-header {
    padding: var(--space-4) 0;
  }

  .app-title {
    font-size: var(--font-size-lg);
  }

  .upload-zone {
    padding: var(--space-6) var(--space-3);
  }

  .upload-title {
    font-size: var(--font-size-md);
  }

  .metadata-grid {
    grid-template-columns: 1fr;
  }

  .section-title {
    font-size: var(--font-size-md);
  }

  /* Stack table on mobile - simplified view */
  .table-container {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .transaction-table {
    min-width: 600px;
    font-size: var(--font-size-xs);
  }

  .transaction-table th,
  .transaction-table td {
    padding: var(--space-2);
  }

  .transaction-table td.description-cell {
    max-width: 200px;
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ PRINT STYLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

@media print {
  * {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  body {
    background: white;
    color: black;
  }

  .app-container {
    max-width: none;
    padding: 0;
  }

  /* Hide interactive elements */
  .upload-section,
  .loading-container,
  .error-message {
    display: none !important;
  }

  .app-header {
    border-bottom: 2px solid #333;
    margin-bottom: 1rem;
  }

  .app-title {
    color: #000;
    background: none;
    -webkit-text-fill-color: initial;
  }

  .metadata-card {
    background: white;
    border: 1px solid #ddd;
    box-shadow: none;
    break-inside: avoid;
    page-break-inside: avoid;
  }

  .metadata-card::before {
    display: none;
  }

  .card-label {
    color: #666;
  }

  .card-value,
  .card-value.highlight {
    color: #000;
  }

  .card-subvalue {
    color: #666;
  }

  .table-container {
    background: white;
    border: 1px solid #ddd;
    box-shadow: none;
  }

  .transaction-table thead {
    background: #f5f5f5;
  }

  .transaction-table th {
    background: #f5f5f5;
    color: #333;
    border-bottom: 2px solid #333;
  }

  .transaction-table tbody tr {
    border-bottom: 1px solid #ddd;
  }

  .transaction-table tbody tr:hover {
    background: transparent;
  }

  .transaction-table td {
    color: #000;
  }

  .transaction-table td.amount-cell.credit {
    color: #2e7d32;
  }

  .transaction-table td.amount-cell.debit {
    color: #c62828;
  }

  .transaction-table td.date-cell {
    color: #666;
  }

  /* Ensure table fits on page */
  .transaction-table {
    font-size: 10pt;
  }

  .transaction-table th,
  .transaction-table td {
    padding: 0.25rem 0.5rem;
  }

  .section-title {
    color: #000;
    margin-top: 1rem;
  }

  .transaction-count {
    background: #f5f5f5;
    border-color: #ddd;
    color: #333;
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ UTILITY CLASSES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

.hidden {
  display: none !important;
}

.visible {
  display: block !important;
}

.text-center {
  text-align: center;
}

.text-right {
  text-align: right;
}

.text-muted {
  color: var(--text-muted);
}

.font-mono {
  font-family: var(--font-mono);
}

.mt-4 { margin-top: var(--space-4); }
.mt-6 { margin-top: var(--space-6); }
.mb-4 { margin-bottom: var(--space-4); }
.mb-6 { margin-bottom: var(--space-6); }
  </style>
</head>
<body>
  <div class="app-container">
    
    <!-- HEADER -->
    <header class="app-header">
      <div class="app-logo">
        <div class="app-logo-icon">ğŸ“Š</div>
        <h1 class="app-title">OFX Reader</h1>
      </div>
      <p class="app-subtitle">Leitor de Extratos BancÃ¡rios</p>
    </header>

    <!-- UPLOAD SECTION -->
    <section class="upload-section">
      <div class="upload-zone" id="uploadZone">
        <span class="upload-icon">ğŸ“„</span>
        <h2 class="upload-title">Arraste seu arquivo OFX aqui</h2>
        <p class="upload-subtitle">ou clique para selecionar</p>
        <p class="upload-hint">Arquivos .ofx de bancos brasileiros</p>
        <input type="file" id="fileInput" class="file-input" accept=".ofx">
      </div>
    </section>

    <!-- LOADING STATE -->
    <div class="loading-container" id="loadingContainer">
      <div class="spinner"></div>
      <span class="loading-text">Processando arquivo...</span>
    </div>

    <!-- ERROR MESSAGE -->
    <div class="error-message" id="errorMessage">
      <span class="error-icon">âš ï¸</span>
      <span class="error-text" id="errorText"></span>
    </div>

    <!-- DATA SECTION (hidden initially) -->
    <div class="data-section" id="dataSection">
      
      <!-- METADATA CARDS -->
      <section class="metadata-section">
        <div class="section-header">
          <h2 class="section-title">
            <span class="section-title-icon">ğŸ </span>
            InformaÃ§Ãµes da Conta
          </h2>
        </div>
        <div class="metadata-grid" id="metadataGrid">
          <!-- Cards will be inserted here by JavaScript -->
        </div>
      </section>

      <!-- TRANSACTIONS TABLE -->
      <section class="transactions-section">
        <div class="section-header">
          <h2 class="section-title">
            <span class="section-title-icon">ğŸ“‹</span>
            TransaÃ§Ãµes
          </h2>
          <span class="transaction-count" id="transactionCount">
            <span>ğŸ“Š</span>
            <span id="countText">0 transaÃ§Ãµes</span>
          </span>
        </div>
        <div class="table-container">
          <div class="table-scroll-wrapper">
            <table class="transaction-table">
              <thead>
                <tr>
                  <th>Data</th>
                  <th class="align-right">Valor</th>
                  <th>DescriÃ§Ã£o</th>
                </tr>
              </thead>
              <tbody id="transactionTableBody">
                <!-- Rows will be inserted here by JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </section>

    </div>

  </div>

  <script>
'use strict';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION 1: CONFIGURATION & CONSTANTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const CONFIG = {
  fileAccept: '.ofx',
  dateFormat: 'DD-MM-YYYY',
  currency: 'BRL',
  locale: 'pt-BR',
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION 2: STATE MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const AppState = {
  status: 'initial',  // 'initial' | 'loading' | 'success' | 'error'
  ofxData: null,      // Parsed OFX data (metadata + transactions)
  error: null,        // Error message string
  fileName: null,     // Currently loaded file name
};

/**
 * Update state and re-render. This is the ONLY way to change the UI.
 */
function updateState(newState) {
  Object.assign(AppState, newState);
  render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION 3: UTILITY FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * Safely get a nested property. Never throws.
 */
function safeGet(obj, path, defaultValue = null) {
  if (obj == null) return defaultValue;
  const keys = path.split('.');
  let current = obj;
  for (const key of keys) {
    if (current == null || typeof current !== 'object') return defaultValue;
    current = current[key];
  }
  return current ?? defaultValue;
}

/**
 * Parse a number safely. Never returns NaN.
 */
function safeNumber(value, defaultValue = 0) {
  if (value == null) return defaultValue;
  if (typeof value === 'number') return isNaN(value) ? defaultValue : value;
  const parsed = parseFloat(String(value).replace(/[^\d.-]/g, ''));
  return isNaN(parsed) ? defaultValue : parsed;
}

/**
 * Safe string â€” never null/undefined, always trimmed.
 */
function safeString(value, defaultValue = '') {
  if (value == null) return defaultValue;
  return String(value).trim() || defaultValue;
}

/**
 * Escape HTML to prevent XSS. Use when inserting user data into DOM.
 */
function escapeHtml(str) {
  if (str == null) return '';
  const div = document.createElement('div');
  div.textContent = String(str);
  return div.innerHTML;
}

/**
 * Wrap event handlers to prevent crashes.
 */
function safeHandler(fn) {
  return function(event) {
    try {
      fn.call(this, event);
    } catch (error) {
      console.error('[Event Handler Error]', error);
      updateState({ 
        status: 'error', 
        error: 'Something went wrong. Please try again.',
      });
    }
  };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION 4: CORE LOGIC (OFX PARSING)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * Fix Portuguese encoding issues (Windows-1252 corruption in "ASCII" files)
 * PCD Section 5.2
 * 
 * Handles multiple corruption patterns:
 * 1. UTF-8 double-encoding (ÃƒÂ§ â†’ Ã§, ÃƒÂ£ â†’ Ã£, etc.)
 * 2. Replacement characters (ï¿½ â†’ proper character based on context)
 * 3. ISO-8859-1/Windows-1252 bytes read as UTF-8
 */
function fixPortugueseEncoding(text) {
  if (!text) return '';
  
  // Pattern 1: UTF-8 double-encoding (most common in OFX files)
  const doubleEncodingMap = {
    // Lowercase
    'ÃƒÂ§': 'Ã§', 'ÃƒÂ£': 'Ã£', 'ÃƒÂ¡': 'Ã¡', 'ÃƒÂ©': 'Ã©', 'ÃƒÂ­': 'Ã­', 
    'ÃƒÂ³': 'Ã³', 'ÃƒÂº': 'Ãº', 'Ãƒ ': 'Ã ', 'ÃƒÂ¢': 'Ã¢', 'ÃƒÂª': 'Ãª', 
    'ÃƒÂ´': 'Ã´', 'ÃƒÂµ': 'Ãµ', 'ÃƒÂ¨': 'Ã¨', 'ÃƒÂ¬': 'Ã¬', 'ÃƒÂ²': 'Ã²',
    'ÃƒÂ¹': 'Ã¹', 'ÃƒÂ¼': 'Ã¼', 'ÃƒÂ±': 'Ã±',
    // Common combinations
    'ÃƒÂ£o': 'Ã£o', 'ÃƒÂ§ÃƒÂ£o': 'Ã§Ã£o', 'ÃƒÂ§ÃƒÂµes': 'Ã§Ãµes',
    // Uppercase
    'Ãƒâ€¡': 'Ã‡', 'ÃƒÆ’': 'Ãƒ', 'Ãƒ': 'Ã', 'Ãƒâ€°': 'Ã‰', 'Ãƒ': 'Ã', 
    'Ãƒ"': 'Ã“', 'ÃƒÅ¡': 'Ãš', 'Ãƒâ‚¬': 'Ã€', 'Ãƒâ€š': 'Ã‚', 'ÃƒÅ ': 'ÃŠ', 
    'Ãƒ"': 'Ã”', 'Ãƒâ€¢': 'Ã•',
  };
  
  // Pattern 2: Context-aware replacement character fixes
  const replacementCharMap = {
    // Common patterns with replacement character (ï¿½)
    'Dï¿½B': 'DÃ‰B',           // DÃ©bito
    'CRï¿½D': 'CRÃ‰D',         // CrÃ©dito
    'SERVIï¿½OS': 'SERVIÃ‡OS', // ServiÃ§os
    'CONVï¿½NIO': 'CONVÃŠNIO', // ConvÃªnio
    'OPï¿½ï¿½O': 'OPÃ‡ÃƒO',       // OpÃ§Ã£o
    'TRANSAï¿½ï¿½O': 'TRANSAÃ‡ÃƒO', // TransaÃ§Ã£o
    'DEPï¿½SITO': 'DEPÃ“SITO', // DepÃ³sito
    'TRANSFERï¿½NCIA': 'TRANSFERÃŠNCIA', // TransferÃªncia
    'Saï¿½de': 'SaÃºde',       // SaÃºde
    'Foz do Iguaï¿½u': 'Foz do IguaÃ§u', // IguaÃ§u
    // Single character replacements context
    'ï¿½gua': 'Ã¡gua',
    'ï¿½nico': 'Ãºnico',
    'ï¿½ï¿½o': 'Ã§Ã£o',
    'ï¿½ï¿½es': 'Ã§Ãµes',
  };
  
  // Pattern 3: Single replacement character â†’ most likely character
  const singleCharFixes = {
    'Aï¿½': 'AÃ‡',
    'Oï¿½': 'OÃ‡',
    'Eï¿½': 'EÃ‡',
    'Iï¿½': 'IÃ‡',
    'Uï¿½': 'UÃ‡',
    'Ã‡ï¿½': 'Ã‡Ãƒ',
    'ï¿½A': 'Ã‡A',
    'ï¿½O': 'Ã‡O',
    'ï¿½E': 'Ã‡E',
    'ï¿½I': 'Ã‡I',
    'ï¿½U': 'Ã‡U',
  };
  
  let result = text;
  
  // Apply double-encoding fixes first
  for (const [corrupt, correct] of Object.entries(doubleEncodingMap)) {
    result = result.replaceAll(corrupt, correct);
  }
  
  // Apply context-aware replacement character fixes
  for (const [corrupt, correct] of Object.entries(replacementCharMap)) {
    result = result.replaceAll(corrupt, correct);
  }
  
  // Apply single character fixes
  for (const [corrupt, correct] of Object.entries(singleCharFixes)) {
    result = result.replaceAll(corrupt, correct);
  }
  
  // Final pass: if still has ï¿½ (replacement char), try common Portuguese substitutions
  if (result.includes('ï¿½')) {
    result = result
      .replace(/ï¿½([aeiou])/gi, (match, vowel) => {
        // ï¿½ before vowel is likely Ã§
        return 'Ã§' + vowel;
      })
      .replace(/([AEIOU])ï¿½/g, (match, vowel) => {
        // Vowel + ï¿½ is likely vowel with tilde or cedilla
        const mapping = { 'A': 'Ãƒ', 'E': 'Ã‰', 'I': 'Ã', 'O': 'Ã“', 'U': 'Ãš' };
        return mapping[vowel] || match;
      });
  }
  
  return result;
}

/**
 * Extract single tag value from OFX content
 * Used by parseOFXFile
 */
function extractTag(content, tagName) {
  if (!content || !tagName) return null;
  
  // Pattern: <TAG>value or <TAG>value</TAG>
  const regex = new RegExp(`<${tagName}>([^<]*(?:</[^>]+>)?)`, 'i');
  const match = content.match(regex);
  
  if (!match) return null;
  
  let value = match[1].trim();
  // Remove closing tag if present
  value = value.replace(/<\/[^>]+>$/, '').trim();
  
  return value || null;
}

/**
 * Extract all blocks between start and end tags
 * Used by parseOFXFile for transactions
 */
function extractAllBetween(content, startTag, endTag) {
  if (!content || !startTag || !endTag) return [];
  
  const blocks = [];
  const regex = new RegExp(`${startTag}([\\s\\S]*?)${endTag}`, 'gi');
  let match;
  
  while ((match = regex.exec(content)) !== null) {
    blocks.push(match[1]);
  }
  
  return blocks;
}

/**
 * Convert OFX date formats to DD-MM-YYYY
 * PCD Section 5.3
 */
function parseOFXDate(dateStr) {
  if (!dateStr) return null;
  
  // Remove timezone: YYYYMMDDHHMMSS[-03:EST] â†’ YYYYMMDD
  const cleanDate = dateStr.split('[')[0].substring(0, 8);
  
  if (cleanDate.length !== 8) return null;
  
  const year = cleanDate.substring(0, 4);
  const month = cleanDate.substring(4, 6);
  const day = cleanDate.substring(6, 8);
  
  // Validate
  const y = parseInt(year, 10);
  const m = parseInt(month, 10);
  const d = parseInt(day, 10);
  
  if (isNaN(y) || isNaN(m) || isNaN(d)) return null;
  if (m < 1 || m > 12) return null;
  if (d < 1 || d > 31) return null;
  
  return `${day}-${month}-${year}`;
}

/**
 * Extract transaction from STMTTRN block
 * PCD Section 5.4
 */
function parseTransaction(block) {
  if (!block) return null;
  
  const typeRaw = extractTag(block, 'TRNTYPE');
  const dateRaw = extractTag(block, 'DTPOSTED');
  const amountRaw = extractTag(block, 'TRNAMT');
  const memo = extractTag(block, 'MEMO') || extractTag(block, 'NAME') || 'No description';
  
  // Validate required fields
  if (!dateRaw || !amountRaw) {
    console.warn('[parseTransaction] Skipping: missing date or amount');
    return null;
  }
  
  const date = parseOFXDate(dateRaw);
  if (!date) {
    console.warn('[parseTransaction] Skipping: invalid date', dateRaw);
    return null;
  }
  
  const amount = parseFloat(amountRaw);
  if (isNaN(amount)) {
    console.warn('[parseTransaction] Skipping: invalid amount', amountRaw);
    return null;
  }
  
  // Map transaction type
  let type = 'OTHER';
  if (typeRaw) {
    const typeUpper = typeRaw.toUpperCase();
    if (['CREDIT', 'DEBIT', 'PAYMENT', 'OTHER'].includes(typeUpper)) {
      type = typeUpper;
    }
  }
  
  return {
    type,
    date,
    amount,
    description: memo.trim(),
  };
}

/**
 * Format amounts as Brazilian Real (R$ X.XXX,XX)
 * PCD Section 5.5
 */
function formatCurrency(value) {
  if (value == null || isNaN(value)) {
    return 'R$ 0,00';
  }
  
  const absValue = Math.abs(value);
  
  // Format to 2 decimal places
  let formatted = absValue.toFixed(2); // "1234.56"
  
  // Replace decimal point with comma
  const parts = formatted.split('.');
  const integerPart = parts[0];
  const decimalPart = parts[1];
  
  // Add thousand separators
  let withSeparators = '';
  for (let i = integerPart.length - 1, count = 0; i >= 0; i--, count++) {
    if (count > 0 && count % 3 === 0) {
      withSeparators = '.' + withSeparators;
    }
    withSeparators = integerPart[i] + withSeparators;
  }
  
  return `R$ ${withSeparators},${decimalPart}`;
}

/**
 * Main OFX parser - extract all data from file
 * PCD Section 5.1
 */
function parseOFXFile(fileContent) {
  if (!fileContent || typeof fileContent !== 'string') {
    throw new Error('Empty file content');
  }
  
  // Fix encoding issues first
  const content = fixPortugueseEncoding(fileContent);
  
  // Validate OFX header
  if (!content.includes('OFXHEADER') && !content.includes('<OFX>')) {
    throw new Error('Invalid OFX file');
  }
  
  // Initialize result
  const result = {
    metadata: {},
    transactions: [],
  };
  
  // Extract metadata
  result.metadata.bankName = extractTag(content, 'ORG') || 'Unknown Bank';
  result.metadata.bankId = extractTag(content, 'BANKID') || extractTag(content, 'FID');
  result.metadata.accountId = extractTag(content, 'ACCTID');
  result.metadata.branchId = extractTag(content, 'BRANCHID');
  result.metadata.accountType = extractTag(content, 'ACCTTYPE');
  result.metadata.currency = extractTag(content, 'CURDEF') || 'BRL';
  
  // Extract dates
  const startDateRaw = extractTag(content, 'DTSTART');
  if (startDateRaw) {
    result.metadata.startDate = parseOFXDate(startDateRaw);
  }
  
  const endDateRaw = extractTag(content, 'DTEND');
  if (endDateRaw) {
    result.metadata.endDate = parseOFXDate(endDateRaw);
  }
  
  // Extract balance
  const balanceRaw = extractTag(content, 'BALAMT');
  if (balanceRaw) {
    result.metadata.balance = parseFloat(balanceRaw);
  }
  
  const balanceDateRaw = extractTag(content, 'DTASOF');
  if (balanceDateRaw) {
    result.metadata.balanceDate = parseOFXDate(balanceDateRaw);
  }
  
  // Extract transactions
  const transactionBlocks = extractAllBetween(content, '<STMTTRN>', '</STMTTRN>');
  
  for (const block of transactionBlocks) {
    const transaction = parseTransaction(block);
    if (transaction) {
      result.transactions.push(transaction);
    }
  }
  
  if (result.transactions.length === 0) {
    throw new Error('No valid transactions found');
  }
  
  return result;
}

/**
 * Process uploaded file
 * PCD Section 5.6
 */
function handleFileUpload(file) {
  if (!file) {
    updateState({ status: 'error', error: 'No file selected' });
    return;
  }
  
  if (!file.name.toLowerCase().endsWith('.ofx')) {
    updateState({ status: 'error', error: 'Please select an OFX file' });
    return;
  }
  
  updateState({ status: 'loading', fileName: file.name });
  
  const reader = new FileReader();
  
  reader.onload = function(e) {
    try {
      let content = e.target.result;
      
      // Detect encoding issues: if we have many ï¿½ (replacement characters) and file declares CHARSET:1252
      const hasReplacementChars = content.includes('ï¿½');
      const declaresWindows1252 = /CHARSET:\s*1252/i.test(content);
      
      if (hasReplacementChars && declaresWindows1252) {
        // Try to recover by reading as ISO-8859-1 / Windows-1252
        // FileReader doesn't support Windows-1252 directly, so we'll use binary read
        const binaryReader = new FileReader();
        binaryReader.onload = function(binaryEvent) {
          try {
            // Read as array buffer, then decode as Latin1
            const bytes = new Uint8Array(binaryEvent.target.result);
            let latin1Content = '';
            for (let i = 0; i < bytes.length; i++) {
              latin1Content += String.fromCharCode(bytes[i]);
            }
            
            // Now apply encoding fixes
            const ofxData = parseOFXFile(latin1Content);
            updateState({ 
              status: 'success', 
              ofxData,
              error: null,
            });
          } catch (error) {
            console.error('[handleFileUpload] Binary read parse error:', error);
            // Fall back to UTF-8 parsing with enhanced fixes
            try {
              const ofxData = parseOFXFile(content);
              updateState({ 
                status: 'success', 
                ofxData,
                error: null,
              });
            } catch (fallbackError) {
              updateState({ 
                status: 'error', 
                error: fallbackError.message || 'Unable to read file. The OFX file may be corrupted.',
              });
            }
          }
        };
        binaryReader.onerror = function() {
          updateState({ 
            status: 'error', 
            error: 'Failed to read file. Please try again.',
          });
        };
        binaryReader.readAsArrayBuffer(file);
      } else {
        // Standard UTF-8 parsing
        const ofxData = parseOFXFile(content);
        updateState({ 
          status: 'success', 
          ofxData,
          error: null,
        });
      }
    } catch (error) {
      console.error('[handleFileUpload] Parse error:', error);
      updateState({ 
        status: 'error', 
        error: error.message || 'Unable to read file. The OFX file may be corrupted.',
      });
    }
  };
  
  reader.onerror = function() {
    updateState({ 
      status: 'error', 
      error: 'Failed to read file. Please try again.',
    });
  };
  
  reader.readAsText(file, 'UTF-8');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION 5: UI RENDERING FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * Master render function - dispatches to state-specific renderers
 */
function render() {
  // Get containers
  const loadingContainer = document.getElementById('loadingContainer');
  const errorMessage = document.getElementById('errorMessage');
  const dataSection = document.getElementById('dataSection');
  
  if (!loadingContainer || !errorMessage || !dataSection) {
    console.error('[render] Required DOM elements not found');
    return;
  }
  
  // Reset visibility
  loadingContainer.classList.remove('visible');
  errorMessage.classList.remove('visible');
  dataSection.classList.remove('visible');
  
  switch (AppState.status) {
    case 'initial':
      // Upload section visible, others hidden (default state)
      break;
      
    case 'loading':
      loadingContainer.classList.add('visible');
      break;
      
    case 'success':
      dataSection.classList.add('visible');
      renderMetadata();
      renderTransactions();
      break;
      
    case 'error':
      errorMessage.classList.add('visible');
      const errorText = document.getElementById('errorText');
      if (errorText) {
        errorText.textContent = AppState.error || 'An error occurred';
      }
      break;
      
    default:
      // Unknown state - show error
      errorMessage.classList.add('visible');
      const errorTextDefault = document.getElementById('errorText');
      if (errorTextDefault) {
        errorTextDefault.textContent = 'Unknown application state';
      }
  }
}

/**
 * Render metadata cards
 */
function renderMetadata() {
  const container = document.getElementById('metadataGrid');
  if (!container || !AppState.ofxData) return;
  
  container.innerHTML = '';
  const metadata = AppState.ofxData.metadata;
  
  // Define cards with icons
  const cards = [
    {
      icon: 'ğŸ¦',
      label: 'Banco',
      value: metadata.bankName || 'N/A',
      subvalue: metadata.bankId ? `CÃ³digo: ${metadata.bankId}` : null,
    },
    {
      icon: 'ğŸ’³',
      label: 'Conta',
      value: metadata.accountId || 'N/A',
      subvalue: metadata.accountType || null,
    },
    {
      icon: 'ğŸ”–',
      label: 'AgÃªncia',
      value: metadata.branchId || 'N/A',
      subvalue: null,
    },
    {
      icon: 'ğŸ“…',
      label: 'PerÃ­odo',
      value: metadata.startDate && metadata.endDate 
        ? `${metadata.startDate} a ${metadata.endDate}`
        : 'N/A',
      subvalue: null,
    },
    {
      icon: 'ğŸ’°',
      label: 'Saldo',
      value: metadata.balance != null ? formatCurrency(metadata.balance) : 'N/A',
      subvalue: metadata.balanceDate ? `Atualizado em ${metadata.balanceDate}` : null,
      highlight: metadata.balance != null,
      isBalance: true,
    },
    {
      icon: 'ğŸ’µ',
      label: 'Moeda',
      value: metadata.currency || 'N/A',
      subvalue: null,
    },
  ];
  
  // Create cards
  for (const card of cards) {
    const cardEl = document.createElement('div');
    cardEl.className = 'metadata-card';
    
    // Icon
    const icon = document.createElement('div');
    icon.className = 'card-icon';
    icon.textContent = card.icon;
    cardEl.appendChild(icon);
    
    // Label
    const label = document.createElement('div');
    label.className = 'card-label';
    label.textContent = card.label;
    cardEl.appendChild(label);
    
    // Value
    const value = document.createElement('div');
    let valueClass = 'card-value';
    if (card.highlight) valueClass += ' highlight';
    if (card.isBalance && metadata.balance != null) {
      valueClass += metadata.balance >= 0 ? ' balance-positive' : ' balance-negative';
    }
    value.className = valueClass;
    value.textContent = card.value;
    cardEl.appendChild(value);
    
    // Subvalue
    if (card.subvalue) {
      const subvalue = document.createElement('div');
      subvalue.className = 'card-subvalue';
      subvalue.textContent = card.subvalue;
      cardEl.appendChild(subvalue);
    }
    
    container.appendChild(cardEl);
  }
}

/**
 * Render transaction table
 */
function renderTransactions() {
  const tbody = document.getElementById('transactionTableBody');
  const countText = document.getElementById('countText');
  
  if (!tbody || !AppState.ofxData) return;
  
  tbody.innerHTML = '';
  const transactions = AppState.ofxData.transactions;
  
  // Update count
  if (countText) {
    const count = transactions.length;
    countText.textContent = `${count} transaÃ§Ã£o${count !== 1 ? 'Ãµes' : ''}`;
  }
  
  // Create rows with staggered animation
  transactions.forEach((transaction, index) => {
    const row = document.createElement('tr');
    
    // Add staggered animation delay (max 30 for performance)
    const delay = Math.min(index * 0.02, 0.6);
    row.style.animationDelay = `${delay}s`;
    
    // Date cell
    const dateCell = document.createElement('td');
    dateCell.className = 'date-cell';
    dateCell.textContent = transaction.date;
    row.appendChild(dateCell);
    
    // Amount cell
    const amountCell = document.createElement('td');
    const amountClass = transaction.amount >= 0 ? 'credit' : 'debit';
    amountCell.className = `amount-cell ${amountClass}`;
    amountCell.textContent = formatCurrency(transaction.amount);
    row.appendChild(amountCell);
    
    // Description cell
    const descCell = document.createElement('td');
    descCell.className = 'description-cell';
    descCell.textContent = transaction.description;
    row.appendChild(descCell);
    
    tbody.appendChild(row);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION 6: EVENT HANDLERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * Set up all event listeners
 */
function setupEventListeners() {
  const uploadZone = document.getElementById('uploadZone');
  const fileInput = document.getElementById('fileInput');
  
  if (!uploadZone || !fileInput) {
    throw new Error('Required DOM elements not found');
  }
  
  // Upload zone click
  uploadZone.addEventListener('click', safeHandler(function() {
    fileInput.click();
  }));
  
  // File input change
  fileInput.addEventListener('change', safeHandler(function(e) {
    const file = e.target.files[0];
    if (file) {
      handleFileUpload(file);
    }
    // Reset input so same file can be selected again
    e.target.value = '';
  }));
  
  // Drag and drop
  uploadZone.addEventListener('dragover', safeHandler(function(e) {
    e.preventDefault();
    uploadZone.classList.add('dragover');
  }));
  
  uploadZone.addEventListener('dragleave', safeHandler(function(e) {
    e.preventDefault();
    uploadZone.classList.remove('dragover');
  }));
  
  uploadZone.addEventListener('drop', safeHandler(function(e) {
    e.preventDefault();
    uploadZone.classList.remove('dragover');
    
    const file = e.dataTransfer.files[0];
    if (file) {
      handleFileUpload(file);
    }
  }));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SECTION 7: INITIALIZATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

document.addEventListener('DOMContentLoaded', function() {
  try {
    // Initialize in initial state
    updateState({ status: 'initial' });
    
    // Set up event listeners
    setupEventListeners();
    
    console.log('[OFX Reader] Application initialized successfully');
  } catch (error) {
    console.error('[init] Failed to initialize:', error);
    document.body.innerHTML = '<div style="color: #f44336; padding: 2rem; text-align: center; font-family: sans-serif;"><h1>Failed to start application</h1><p>Please refresh the page. If the problem persists, check the browser console for details.</p></div>';
  }
});
  </script>
</body>
</html>
